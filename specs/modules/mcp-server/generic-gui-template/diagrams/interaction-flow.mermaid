sequenceDiagram
    participant User
    participant Claude CLI
    participant MCP Server
    participant Agent System
    participant Vision API
    participant GUI App
    
    User->>Claude CLI: "Open File menu and create new document"
    Claude CLI->>MCP Server: MCP Request (Tool: analyze)
    
    rect rgb(240, 248, 255)
        Note over MCP Server: Screen Analysis Phase
        MCP Server->>GUI App: Capture Screenshot
        GUI App-->>MCP Server: Screenshot Data
        MCP Server->>Vision API: Analyze UI Elements
        Vision API-->>MCP Server: Element Detection Results
        MCP Server->>MCP Server: Cache UI Elements
    end
    
    rect rgb(255, 248, 240)
        Note over Agent System: Agent Delegation Phase
        MCP Server->>Agent System: Request Navigation Agent
        Agent System->>Agent System: Select GUI Automation Agent
        Agent System-->>MCP Server: Agent Ready
    end
    
    rect rgb(248, 255, 240)
        Note over MCP Server: Interaction Phase
        MCP Server->>MCP Server: Locate "File" Menu
        MCP Server->>GUI App: Click(x=120, y=35)
        GUI App-->>MCP Server: Menu Opened
        
        MCP Server->>GUI App: Capture Updated Screen
        GUI App-->>MCP Server: Screenshot with Menu
        
        MCP Server->>Vision API: Find "New" Option
        Vision API-->>MCP Server: New Option Location
        
        MCP Server->>GUI App: Click(x=125, y=85)
        GUI App-->>MCP Server: New Document Created
    end
    
    MCP Server-->>Claude CLI: Success Response
    Claude CLI-->>User: "Created new document successfully"
    
    Note over User, GUI App: Verification Loop
    
    User->>Claude CLI: "What's on the screen now?"
    Claude CLI->>MCP Server: MCP Request (Resource: screenshot://current)
    MCP Server->>GUI App: Capture Current State
    GUI App-->>MCP Server: Screenshot
    MCP Server->>Vision API: Describe Screen
    Vision API-->>MCP Server: Screen Description
    MCP Server-->>Claude CLI: Current State Info
    Claude CLI-->>User: "New document is open with blank canvas..."