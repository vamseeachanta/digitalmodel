graph TD
    START[Start Processing]
    
    START --> SCAN[Scan Input Files]
    SCAN --> CALC[Calculate File Sizes]
    
    CALC --> DIST{Size Distribution}
    
    DIST -->|All Small<br/><100MB| SMALL_BATCH[Small File Strategy]
    DIST -->|All Large<br/>>500MB| LARGE_BATCH[Large File Strategy]
    DIST -->|Mixed Sizes| MIXED_BATCH[Mixed Strategy]
    
    %% Small File Processing
    SMALL_BATCH --> S_THREADS[45 Threads]
    S_THREADS --> S_MEM[5GB per Thread]
    S_MEM --> S_PROC[High Parallelism<br/>Fast I/O]
    
    %% Large File Processing
    LARGE_BATCH --> L_THREADS[15 Threads]
    L_THREADS --> L_MEM[16GB per Thread]
    L_MEM --> L_PROC[Low Parallelism<br/>Memory Intensive]
    
    %% Mixed Processing
    MIXED_BATCH --> GROUP[Group by Size]
    GROUP --> M_SMALL[Small Group<br/>45 threads]
    GROUP --> M_MED[Medium Group<br/>30 threads]
    GROUP --> M_LARGE[Large Group<br/>15 threads]
    
    M_SMALL --> QUEUE1[Process Queue 1]
    M_MED --> QUEUE2[Process Queue 2]
    M_LARGE --> QUEUE3[Process Queue 3]
    
    %% Resource Monitoring
    S_PROC --> MONITOR[Resource Monitor]
    L_PROC --> MONITOR
    QUEUE1 --> MONITOR
    QUEUE2 --> MONITOR
    QUEUE3 --> MONITOR
    
    MONITOR --> CHECK{Resource Check}
    CHECK -->|Memory > 80%| REDUCE[Reduce Threads]
    CHECK -->|CPU < 50%| INCREASE[Increase Threads]
    CHECK -->|Optimal| CONTINUE[Continue]
    
    REDUCE --> ADJUST[Adjust Allocation]
    INCREASE --> ADJUST
    CONTINUE --> COMPLETE[Processing Complete]
    ADJUST --> MONITOR
    
    %% Performance Metrics
    COMPLETE --> METRICS[Collect Metrics]
    METRICS --> REPORT[Performance Report]
    REPORT --> LEARN[Update Strategy]
    LEARN -.->|Feedback| CALC
    
    %% Styling
    classDef decision fill:#fff2cc,stroke:#d6b656,stroke-width:2px
    classDef strategy fill:#dae8fc,stroke:#6c8ebf,stroke-width:2px
    classDef process fill:#d5e8d4,stroke:#82b366,stroke-width:2px
    classDef monitor fill:#ffe6cc,stroke:#d79b00,stroke-width:2px
    
    class DIST,CHECK decision
    class SMALL_BATCH,LARGE_BATCH,MIXED_BATCH,S_THREADS,L_THREADS,GROUP strategy
    class S_PROC,L_PROC,QUEUE1,QUEUE2,QUEUE3 process
    class MONITOR,REDUCE,INCREASE,ADJUST monitor