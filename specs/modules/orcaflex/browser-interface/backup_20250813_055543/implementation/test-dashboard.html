<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OrcaFlex Browser Interface - Test</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .dashboard-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        .parameter-panel, .search-panel {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #2d3748;
        }
        select, input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #cbd5e0;
            border-radius: 4px;
            font-size: 14px;
        }
        .button {
            background: #4299e1;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
        }
        .button:hover {
            background: #3182ce;
        }
        .mode-toggle {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 28px;
            margin-right: 10px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 28px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: #4299e1;
        }
        input:checked + .slider:before {
            transform: translateX(32px);
        }
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        .status-success {
            background: #c6f6d5;
            color: #22543d;
        }
        .status-warning {
            background: #fed7d7;
            color: #742a2a;
        }
        .pattern-display {
            background: #f7fafc;
            padding: 12px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            margin-top: 10px;
        }
        .grid {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
        }
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function BrowserInterface() {
            const [config, setConfig] = useState({
                vessel_type: 'fsts',
                loading_condition: 'l015',
                tide_level: 'hwl',
                return_period: '0100yr',
                wave_direction: '000deg',
                analysis_type: '03c',
                auto_max: true
            });

            const [pattern, setPattern] = useState('');
            const [searchResults, setSearchResults] = useState(null);
            const [savedConfigs, setSavedConfigs] = useState([]);

            // Generate pattern when config changes
            useEffect(() => {
                if (!config.auto_max) {
                    const parts = [
                        config.vessel_type,
                        config.analysis_type,
                        config.return_period,
                        config.loading_condition,
                        config.tide_level
                    ];
                    setPattern(parts.filter(Boolean).join('_'));
                } else {
                    setPattern('AUTO-MAX MODE - Using maximum force configuration');
                }
            }, [config]);

            // Simulate file search
            const performSearch = () => {
                setSearchResults({
                    total_files: Math.floor(Math.random() * 50) + 10,
                    categories: ['strut', 'jacket', 'mooring'],
                    search_time: (Math.random() * 0.5).toFixed(2)
                });
            };

            // Save configuration
            const saveConfig = () => {
                const name = prompt('Enter configuration name:');
                if (name) {
                    const newConfig = {
                        id: Date.now(),
                        name,
                        config: {...config},
                        saved_at: new Date().toLocaleString()
                    };
                    setSavedConfigs([...savedConfigs, newConfig]);
                    localStorage.setItem('saved_configs', JSON.stringify([...savedConfigs, newConfig]));
                    alert(`Configuration "${name}" saved successfully!`);
                }
            };

            // Load saved configs on mount
            useEffect(() => {
                const saved = localStorage.getItem('saved_configs');
                if (saved) {
                    setSavedConfigs(JSON.parse(saved));
                }
            }, []);

            // Load configuration
            const loadConfig = (savedConfig) => {
                setConfig(savedConfig.config);
                alert(`Loaded configuration: ${savedConfig.name}`);
            };

            return (
                <div className="container">
                    <div className="dashboard-header">
                        <h1>OrcaFlex Browser Interface</h1>
                        <p>Manual parameter override and file browsing test interface</p>
                    </div>

                    <div className="grid">
                        {/* Parameter Panel */}
                        <div className="parameter-panel">
                            <h2>Parameters</h2>
                            
                            <div className="mode-toggle">
                                <label className="switch">
                                    <input 
                                        type="checkbox" 
                                        checked={config.auto_max}
                                        onChange={(e) => setConfig({...config, auto_max: e.target.checked})}
                                    />
                                    <span className="slider"></span>
                                </label>
                                <span>Auto-Max Mode {config.auto_max ? 'ON' : 'OFF'}</span>
                            </div>

                            {!config.auto_max && (
                                <>
                                    <div className="form-group">
                                        <label>Vessel Type</label>
                                        <select 
                                            value={config.vessel_type}
                                            onChange={(e) => setConfig({...config, vessel_type: e.target.value})}
                                        >
                                            <option value="fsts">FSTS</option>
                                            <option value="flng">FLNG</option>
                                            <option value="lngc">LNGC</option>
                                        </select>
                                    </div>

                                    <div className="form-group">
                                        <label>Loading Condition</label>
                                        <select 
                                            value={config.loading_condition}
                                            onChange={(e) => setConfig({...config, loading_condition: e.target.value})}
                                        >
                                            <option value="l015">15% LNG</option>
                                            <option value="l050">50% LNG</option>
                                            <option value="l095">95% LNG</option>
                                        </select>
                                    </div>

                                    <div className="form-group">
                                        <label>Tide Level</label>
                                        <select 
                                            value={config.tide_level}
                                            onChange={(e) => setConfig({...config, tide_level: e.target.value})}
                                        >
                                            <option value="hwl">High Water Level</option>
                                            <option value="mwl">Mean Water Level</option>
                                            <option value="lwl">Low Water Level</option>
                                        </select>
                                    </div>

                                    <div className="form-group">
                                        <label>Return Period</label>
                                        <select 
                                            value={config.return_period}
                                            onChange={(e) => setConfig({...config, return_period: e.target.value})}
                                        >
                                            <option value="0001yr">1 Year</option>
                                            <option value="0010yr">10 Year</option>
                                            <option value="0100yr">100 Year</option>
                                        </select>
                                    </div>

                                    <div className="form-group">
                                        <label>Wave Direction</label>
                                        <select 
                                            value={config.wave_direction}
                                            onChange={(e) => setConfig({...config, wave_direction: e.target.value})}
                                        >
                                            <option value="000deg">0°</option>
                                            <option value="045deg">45°</option>
                                            <option value="090deg">90°</option>
                                            <option value="135deg">135°</option>
                                            <option value="180deg">180°</option>
                                            <option value="225deg">225°</option>
                                            <option value="270deg">270°</option>
                                            <option value="315deg">315°</option>
                                        </select>
                                    </div>

                                    <div className="form-group">
                                        <label>Analysis Type</label>
                                        <select 
                                            value={config.analysis_type}
                                            onChange={(e) => setConfig({...config, analysis_type: e.target.value})}
                                        >
                                            <option value="03c">Configuration 3C</option>
                                            <option value="04a">Configuration 4A</option>
                                            <option value="05b">Configuration 5B</option>
                                        </select>
                                    </div>
                                </>
                            )}

                            <div className="pattern-display">
                                <strong>Generated Pattern:</strong><br/>
                                {pattern}
                            </div>

                            <div style={{marginTop: '20px'}}>
                                <button className="button" onClick={performSearch}>
                                    Search Files
                                </button>
                                <button className="button" onClick={saveConfig}>
                                    Save Config
                                </button>
                            </div>
                        </div>

                        {/* Search Results Panel */}
                        <div className="search-panel">
                            <h2>File Search Results</h2>
                            
                            {searchResults ? (
                                <div>
                                    <div style={{marginBottom: '20px'}}>
                                        <span className="status-badge status-success">
                                            {searchResults.total_files} files found
                                        </span>
                                        <span style={{marginLeft: '10px', color: '#718096'}}>
                                            Search completed in {searchResults.search_time}s
                                        </span>
                                    </div>
                                    
                                    <h3>File Categories</h3>
                                    <ul>
                                        {searchResults.categories.map(cat => (
                                            <li key={cat}>
                                                <strong>{cat}:</strong> {Math.floor(Math.random() * 20) + 1} files
                                            </li>
                                        ))}
                                    </ul>

                                    <h3>Sample Files</h3>
                                    <ul style={{fontFamily: 'monospace', fontSize: '12px'}}>
                                        <li>fsts_03c_0100yr_l015_hwl_Strut1.csv</li>
                                        <li>fsts_03c_0100yr_l015_hwl_Jacket1.csv</li>
                                        <li>fsts_03c_0100yr_l015_hwl_Mooring1.csv</li>
                                        <li>dm_fsts_03c_0100yr_l015_hwl_strut_dyn.csv</li>
                                    </ul>
                                </div>
                            ) : (
                                <p style={{color: '#718096'}}>
                                    Configure parameters and click "Search Files" to find matching files
                                </p>
                            )}

                            {savedConfigs.length > 0 && (
                                <div style={{marginTop: '30px'}}>
                                    <h3>Saved Configurations</h3>
                                    <ul>
                                        {savedConfigs.map(saved => (
                                            <li key={saved.id} style={{marginBottom: '10px'}}>
                                                <strong>{saved.name}</strong> - {saved.saved_at}
                                                <button 
                                                    className="button" 
                                                    style={{marginLeft: '10px', padding: '5px 10px', fontSize: '12px'}}
                                                    onClick={() => loadConfig(saved)}
                                                >
                                                    Load
                                                </button>
                                            </li>
                                        ))}
                                    </ul>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<BrowserInterface />, document.getElementById('root'));
    </script>
</body>
</html>