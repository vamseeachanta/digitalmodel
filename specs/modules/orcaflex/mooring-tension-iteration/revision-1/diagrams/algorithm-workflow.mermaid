flowchart TD
    START([Start Iteration Process]) --> LOAD[Load OrcaFlex Model]
    LOAD --> CONFIG[Parse Configuration<br/>Target Tensions & Parameters]
    CONFIG --> VALIDATE[Validate Model Setup<br/>Check Mooring Lines & Properties]
    
    VALIDATE --> BACKUP[Backup Original<br/>Line Properties]
    BACKUP --> INIT[Initialize Algorithm<br/>Set k=0, L⁰=Current Lengths]
    
    INIT --> ANALYSIS[Run Static Analysis<br/>Extract Current Tensions T⁽ᵏ⁾]
    ANALYSIS --> CHECK{Convergence Check<br/>|T⁽ᵏ⁾-T_target|/T_target ≤ ε?}
    
    CHECK -->|Yes| SUCCESS[Convergence Achieved<br/>Generate Report]
    CHECK -->|No| MAXITER{Max Iterations<br/>Reached?}
    
    MAXITER -->|Yes| FAILURE[Convergence Failed<br/>Restore Original State]
    MAXITER -->|No| JACOBIAN[Compute Jacobian Matrix<br/>J_ij = ∂T_i/∂L_j]
    
    JACOBIAN --> RESIDUAL[Calculate Residuals<br/>r⁽ᵏ⁾ = T⁽ᵏ⁾ - T_target]
    RESIDUAL --> SOLVE[Solve Linear System<br/>J⁽ᵏ⁾ΔL⁽ᵏ⁾ = -r⁽ᵏ⁾]
    
    SOLVE --> UPDATE[Update Line Lengths<br/>L⁽ᵏ⁺¹⁾ = L⁽ᵏ⁾ + ΔL⁽ᵏ⁾]
    UPDATE --> SAFETY[Apply Safety Limits<br/>Check Physical Constraints]
    
    SAFETY --> MODIFY[Modify OrcaFlex Model<br/>Update Line Properties]
    MODIFY --> INCREMENT[Increment k → k+1]
    INCREMENT --> ANALYSIS
    
    SUCCESS --> REPORT[Generate Final Report<br/>Convergence Statistics]
    FAILURE --> ERROR[Error Report<br/>Diagnostic Information]
    
    REPORT --> END([End])
    ERROR --> END
    
    %% Styling
    classDef startEnd fill:#4caf50,stroke:#2e7d32,color:white
    classDef process fill:#2196f3,stroke:#1565c0,color:white
    classDef decision fill:#ff9800,stroke:#e65100,color:white
    classDef success fill:#4caf50,stroke:#2e7d32,color:white
    classDef failure fill:#f44336,stroke:#c62828,color:white
    classDef math fill:#9c27b0,stroke:#6a1b9a,color:white
    
    class START,END startEnd
    class LOAD,CONFIG,VALIDATE,BACKUP,INIT,ANALYSIS,JACOBIAN,RESIDUAL,UPDATE,SAFETY,MODIFY,INCREMENT,REPORT process
    class CHECK,MAXITER decision
    class SUCCESS success
    class FAILURE,ERROR failure
    class SOLVE math