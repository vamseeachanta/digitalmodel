Prepare an input file in repo rel path: specs\modules\aqwa for the following task with 10-20 steps on how to get to the end result

based on analysis performed for FSTs and LNGCs in folder below:
D:\1522\ctr9\fatigue_full\rev_a08\base_files\aqwa_to_ofx\input

and using the specs below in repo rel path: 
specs\modules\marine-engineering\core-analysis

can we determine the additional viscous damping used in the aqwa analysis for FST1, FST2 and both LNGCs for both considered drafts


Steps 7?9 assume we have geometry metadata (member centroids, lever arms, Cd/Cm) explicitly encoded in Decks 5?7; please confirm those fields are populated in the
provided .dat files or point me to any supplemental source.

The CoG is defined by an element in deck 1 usually 98000
the restof the decks in the .data file will contain all the data aqwa needs.

For Step 9, should we adopt a specific linearization method (e.g., equivalent linear damping based on expected RAO amplitudes) or is any small-amplitude
approximation acceptable as long as it aligns with the hydrodynamic-coefficients spec?

Additional Notes:
- Need both absolute and percentage damping values
- Plots Prepare percentage damping charts (totalling to 100% for each configuration)


- Utilize Agents appropriately: 
  - aqwa simulation agent in the repo that can be used to run aqwa simulations if needed. 
  - marine engineering analysis agent for any calculations or data processing required.

Calcualtions are done as part of excel file. We will need to reimplement in python as part of the steps below.
specs\modules\marine-engineering\core-analysis\hydrodynamic-coefficients\README.md


Use the anthropic model to  review the input file and psudeocode just generated by equivalent OpenAI model. Ask for any questions or clarifications. also review to see if we can use take advantage of existing modules


### Review Clarifications

   ? **Questions & Clarifications Needed**

   **1. File Pattern Clarification** no space

   Your case file patterns have spaces in the wildcard notation:

   yaml
     files: [FSTS_L015_125KM3_L100_PB_* .{DAT,LIS}]
                                       ? Space here

   Question: Should this be _*.{DAT,LIS} or _*_MWL.{DAT,LIS}? The space will cause glob matching issues.


   **2. Marine Engineering Analysis Agent** Unless absolutely required to streamline work. Utilize current agents

   The spec references a "marine engineering analysis agent" but I don't see this defined in the agents folder.

   Questions:
   ?  Should we create this agent, or is it the same as the AQWA agent? let us use existing agents
   ?  If separate, what are its specific responsibilities vs the AQWA agent?
   ?  Could we use the existing marine_analysis module instead? yes

   **3. Viscous Damping Linearization Method**

   Step 9 mentions "equivalent linear damping about displacement RAO amplitudes" but doesn't specify the formula.

   Questions:
   ?  Which linearization method:
     ?  Statistical linearization: B_eq = (8/3?) * ? * Cd * A * ? * X_rms
     ?  Energy equivalence method
     ?  RMS amplitude method
   ?  Should we use the guidance from specs/modules/marine-engineering/core-analysis/hydrodynamic-coefficients/README.md (which references Morison drag)? review the existing modules and formulas and suggest suitable recommendation.

   **4. Critical Damping Ratio Calculation**

   Pseudocode shows:

   python
     ratio ? total_damping / (2 * sqrt((inertia + added_mass) * restoring))

   Questions:
   ?  Where do we get added_mass? From .LIS A_ij matrices or from Deck data? Review .LIS file
   ?  Should added mass be frequency-dependent or use infinite-frequency limit? do the latter. Show sensitivity between both methods in results
   ?  Which restoring coefficients: C33 (heave), C44 (roll), C55 (pitch)? Yes

   **5. Deck 7 Additional Damping**

   User mentioned "Deck 7 most likely contains additional damping"

   Questions:
   ?  What format is this in? Linear damping coefficients? not sure. refer to aqwa documentation available in repo docs
   ?  Is it DOF-specific or general damping? possibly dof-specific
   ?  Should we validate against user input or extract computationally?

   **6. Percentage Breakdown**

   Spec requires viscous + radiation = 100%  Do all damping as 100%.

   Question: Should we also include:
   ?  Wave drift damping?
   ?  External/user-specified damping?
   ?  Or strictly: radiation (from .LIS) + viscous (from Morison drag) only?


   **7. Interactive Charts**

   HTML reporting standards require Plotly/Bokeh for interactive visualizations.

   Questions:
   ?  What chart types needed:
     ?  Damping vs frequency curves? Yes
     ?  Percentage stacked bar charts? Yes
     ?  Critical damping ratio comparison charts? Yes
   ?  Should we use existing plotly-visualization-agent from CLAUDE.md? yes

   ?? **Suggested Refinements** good refinements. Implement

   **1. Leverage Existing Workflow**

   Rather than building from scratch, extend AqwaRAOs.rao_router():

   python
     class ViscousDampingDetermination(AqwaRAOs):
         def viscous_damping_router(self, cfg: dict):
             # Leverage existing methods
             self.split_dat_to_decks(cfg)
             self.prepare_decks(cfg)

             # Add new methods for viscous analysis
             self.extract_morison_elements(cfg)  # Decks 5, 6, 7
             self.parse_lis_damping_matrices(cfg)  # Use AQWAEnhancedParser
             self.compute_viscous_contributions(cfg)
             self.calculate_critical_ratios(cfg)
             self.generate_html_reports(cfg)

   **2. Simplify Agent Orchestration**

   Instead of "locating agents", use direct module imports:

   python
     from digitalmodel.modules.aqwa.aqwa_analysis_damping import AqwaDamping
     from digitalmodel.modules.marine_analysis.aqwa_enhanced_parser import AQWAEnhancedParser

   **3. Add Validation Steps**

   Missing from pseudocode:
   ?  Validate CoG (element 98000) exists in Deck 1
   ?  Verify LDRG option is enabled
   ?  Check frequency grid consistency between .DAT and .LIS
   ?  Ensure all DOFs (3,4,5) are present in damping matrices

   ?? **Recommended Implementation Approach**

   1. Phase 1: Extend existing modules (1-2 days)
     ?  Add Deck 5, 6, 7 parsers to AqwaDATFiles
     ?  Extend AqwaDamping with viscous calculation methods

   2. Phase 2: Create orchestration script (1 day)
     ?  Build on AqwaRAOs.rao_router() pattern
     ?  Implement case iteration logic

   3. Phase 3: Implement damping calculations (2-3 days)
     ?  Morison drag linearization
     ?  Critical damping ratios
     ?  Percentage breakdown

   4. Phase 4: HTML reporting (1 day)
     ?  Plotly interactive charts
     ?  Summary tables
     ?  Documentation

   Total Estimate: 5-7 days vs 10-14 days building from scratch

### Implementation using GPT-5

implement code for:
specs\modules\aqwa\viscous_damping_determination_input.yml